
-- HIVE table for dataset
CREATE EXTERNAL TABLE IF NOT EXISTS iowa_liquor_sales(invoice string, 
date_sold string, 
store_number int,
store_name string, 
address string, 
city string, 
zipcode int,
geo_location string,
county_num int, 
county_name string,
category string,
category_name string, 
vendor_num int, 
vendor_name string, 
item_num int, 
item_name string, 
pack int,
bottle_volume_ml int, 
state_bottle_cost string, 
state_bottle_retail string,
bottles_sold int, 
sale_dollar int, 
sale_volume_liter int, 
sale_volume_gallon int)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
STORED AS TEXTFILE LOCATION '/user/jmonte80/iowa_liquor_sales/'
TBLPROPERTIES ('skip.header.line.count'='1');


-- Create a table from iowa_liquor_sales with specific columns and removing NULL values
-- To be used for EXCEL MAP
CREATE TABLE IF NOT EXISTS iowa_listing
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE
LOCATION "/user/jmonte80/iowa_listing" 
AS SELECT store_number, store_name, address, city, zipcode, county_num, county_name, item_name, bottles_sold, sale_dollar FROM iowa_liquor_sales 
WHERE store_number IS NOT NULL 
AND store_name IS NOT NULL 
AND address IS NOT NULL
AND city IS NOT NULL
AND zipcode IS NOT NULL
AND county_num IS NOT NULL
AND county_name IS NOT NULL
AND item_name IS NOT NULL
AND bottles_sold IS NOT NULL
AND sale_dollar IS NOT NULL;
